<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Settings - Projexia</title>
    <link rel="stylesheet" href="/css/common.css" />
    <link rel="stylesheet" href="/css/headerAndNavigationBar.css" />
    <link rel="stylesheet" href="/css/footer.css" />
    <link rel="stylesheet" href="/css/modal.css" />
    <link rel="stylesheet" href="/css/settings.css" />
  </head>
  <body>
    <%- include('headerAndNavigationBar') %>
    
    <main class="settings-main">
      <div class="settings-container">
        
        <!-- Header -->
        <div class="settings-header">
          <h1>Settings</h1>
          <p class="settings-subtitle">Manage your account preferences</p>
        </div>

        <!-- Account Information -->
        <section class="settings-section">
          <div class="section-header">
            <svg class="section-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
              <circle cx="12" cy="7" r="4"></circle>
            </svg>
            <h2>Account Information</h2>
          </div>
          
          <div class="info-grid">
            <div class="info-item">
              <label>Full Name</label>
              <p><%= currentUser.fullName %></p>
            </div>
            <div class="info-item">
              <label>Email</label>
              <p><%= currentUser.email %></p>
            </div>
            <div class="info-item">
              <label>Program</label>
              <p><%= currentUser.program %></p>
            </div>
            <div class="info-item">
              <label>Year Level</label>
              <p><%= currentUser.year %> Year</p>
            </div>
            <div class="info-item">
              <label>Member Since</label>
              <p><%= new Date(currentUser.createdAt).toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' }) %></p>
            </div>
          </div>
        </section>

        <!-- Appearance -->
        <section class="settings-section">
          <div class="section-header">
            <svg class="section-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="5"></circle>
              <line x1="12" y1="1" x2="12" y2="3"></line>
              <line x1="12" y1="21" x2="12" y2="23"></line>
              <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
              <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
              <line x1="1" y1="12" x2="3" y2="12"></line>
              <line x1="21" y1="12" x2="23" y2="12"></line>
              <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
              <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
            </svg>
            <h2>Appearance</h2>
          </div>
          
          <div class="setting-item">
            <div class="setting-info">
              <h3>Theme Mode</h3>
              <p>Choose between light and dark mode</p>
            </div>
            <button class="btn-mode" id="themeModeBtn">
              <svg class="mode-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
              </svg>
              <span id="modeText">Dark Mode</span>
            </button>
          </div>
        </section>

        <!-- Security -->
        <section class="settings-section">
          <div class="section-header">
            <svg class="section-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
              <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
            </svg>
            <h2>Security</h2>
          </div>
          
          <div class="setting-item">
            <div class="setting-info">
              <h3>Change Password</h3>
              <p>Update your password to keep your account secure</p>
            </div>
            <button class="btn-action btn-change-password" id="changePasswordBtn">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path>
              </svg>
              Change Password
            </button>
          </div>
        </section>

        <!-- Danger Zone -->
        <section class="settings-section danger-section">
          <div class="section-header">
            <svg class="section-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path>
              <line x1="12" y1="9" x2="12" y2="13"></line>
              <line x1="12" y1="17" x2="12.01" y2="17"></line>
            </svg>
            <h2>Danger Zone</h2>
          </div>
          
          <div class="danger-box">
            <div class="setting-info">
              <h3>Delete Account</h3>
              <p>Permanently delete your account and all your data. This action cannot be undone.</p>
            </div>
            <button class="btn-action btn-delete" id="deleteAccountBtn">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="3 6 5 6 21 6"></polyline>
                <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
              </svg>
              Delete Account
            </button>
          </div>
        </section>

      </div>
    </main>

    <!-- Change Password Modal -->
    <div id="changePasswordModal" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <h2>üîí Change Password</h2>
          <span class="modal-close" id="closeChangePasswordModal">&times;</span>
        </div>
        
        <div class="modal-body">
          <form id="changePasswordForm">
            <div class="form-group">
              <label for="currentPassword">Current Password</label>
              <input 
                type="password" 
                id="currentPassword" 
                name="currentPassword" 
                placeholder="Enter current password"
                required
              />
            </div>

            <div class="form-group">
              <label for="newPasswordChange">New Password</label>
              <input 
                type="password" 
                id="newPasswordChange" 
                name="newPassword" 
                placeholder="At least 8 characters"
                minlength="8"
                required
              />
            </div>

            <div class="form-group">
              <label for="confirmNewPassword">Confirm New Password</label>
              <input 
                type="password" 
                id="confirmNewPassword" 
                name="confirmNewPassword" 
                placeholder="Re-enter new password"
                minlength="8"
                required
              />
            </div>
            
            <div class="modal-actions">
              <button type="button" class="btn-cancel" id="cancelChangePassword">Cancel</button>
              <button type="submit" class="btn-confirm-change">Change Password</button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <!-- Delete Account Confirmation Modal -->
    <div id="deleteModal" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <h2>‚ö†Ô∏è Delete Account</h2>
          <span class="modal-close" id="closeDeleteModal">&times;</span>
        </div>
        
        <div class="modal-body">
          <p class="warning-text">
            <strong>Warning:</strong> This action is permanent and cannot be undone!
          </p>
          <p>All your data will be deleted including:</p>
          <ul class="delete-list">
            <li>‚úó All your projects and images</li>
            <li>‚úó All your comments and likes</li>
            <li>‚úó All your notifications</li>
            <li>‚úó Your account information</li>
          </ul>
          
          <form id="deleteAccountForm">
            <label for="confirmPassword">Enter your password to confirm:</label>
            <input 
              type="password" 
              id="confirmPassword" 
              name="password" 
              placeholder="Your password"
              required
            />
            
            <div class="modal-actions">
              <button type="button" class="btn-cancel" id="cancelDelete">Cancel</button>
              <button type="submit" class="btn-confirm-delete">Delete My Account</button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <%- include('partials/footer') %>
    
    <!-- Socket.IO Client -->
    <script src="/socket.io/socket.io.js"></script>
    <script>
      const USER_ID = "<%= currentUser._id %>";
    </script>
    
    <script src="/js/config.js"></script>
    <script src="/js/passwordToggle.js"></script>
    <script src="/js/modal.js"></script>
    <script src="/js/headerAndNavigationBar.js"></script>
    <script src="/js/footer.js"></script>
    <script src="/js/settings.js"></script>
  </body>
</html>
